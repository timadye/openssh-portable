diff --git a/crypto/CMakeLists.txt b/crypto/CMakeLists.txt
index 137cf70..689122b 100644
--- a/crypto/CMakeLists.txt
+++ b/crypto/CMakeLists.txt
@@ -596,7 +596,7 @@ set(
 	x509/x_all.c
 )
 
-set(COMPAT_SRC empty.c)
+set(COMPAT_SRC empty.c version.rc)
 
 set(CRYPTO_UNEXPORT ${CRYPTO_UNEXPORT} BIO_s_log)
 
@@ -848,12 +848,13 @@ add_library(crypto $<TARGET_OBJECTS:crypto_obj> $<TARGET_OBJECTS:compat_obj> emp
 
 export_symbol(crypto ${CMAKE_CURRENT_BINARY_DIR}/crypto_p.sym)
 target_link_libraries(crypto ${PLATFORM_LIBS})
+set_target_properties(crypto PROPERTIES LINK_FLAGS "/NODEFAULTLIB:kernel32.lib")
+set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} /GUARD:CF /debug /debugtype:cv,fixup /opt:ref /opt:icf /incremental:no")
 set_target_properties(crypto PROPERTIES
-	OUTPUT_NAME crypto
-	ARCHIVE_OUTPUT_NAME crypto
+	OUTPUT_NAME libcrypto
+	ARCHIVE_OUTPUT_NAME libcrypto
 	EXPORT_NAME Crypto
 	VERSION ${CRYPTO_VERSION}
-	SOVERSION ${CRYPTO_MAJOR_VERSION}
 )
 if(NOT CMAKE_VERSION VERSION_LESS 3.27.0)
 	set_target_properties(crypto PROPERTIES DLL_NAME_WITH_SOVERSION TRUE)
